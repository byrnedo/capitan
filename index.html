<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Capitan by byrnedo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Capitan</h1>
      <h2 class="project-tagline">Capitan is a tool for managing multiple Docker containers</h2>
      <a href="https://github.com/byrnedo/capitan" class="btn">View on GitHub</a>
      <a href="https://github.com/byrnedo/capitan/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/byrnedo/capitan/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="capitan" class="anchor" href="#capitan" aria-hidden="true"><span class="octicon octicon-link"></span></a>Capitan</h1>

<p>Capitan is a tool for managing multiple Docker containers based largely on <a href="https://github.com/polonskiy/crowdr">crowdr</a></p>

<p>Capitan is only a wrapper around the docker cli tool, no api usage whatsoever (well... an <code>inspect</code> command here and there).
This means it will basically work with all versions of docker.</p>

<p><img src="output.gif" alt="Capitan showcase"></p>

<h2>
<a id="commands" class="anchor" href="#commands" aria-hidden="true"><span class="octicon octicon-link"></span></a>Commands</h2>

<h3>
<a id="invasive-commands" class="anchor" href="#invasive-commands" aria-hidden="true"><span class="octicon octicon-link"></span></a>Invasive commands</h3>

<ul>
<li>
<p><code>capitan up</code>      Create then run or update containers </p>

<ul>
<li>Recreates if:

<ol>
<li>If newer image is found it will remove the old container and run a new one</li>
<li>Container config has changed</li>
</ol>
</li>
<li><p>Starts stopped containers</p></li>
<li><p>Optionally can attach to output using <code>--attach|-a</code> flag.</p></li>
</ul>
</li>
<li>
<p><code>capitan start</code>   Start stopped containers</p>

<ul>
<li>Optionally can attach to output using <code>--attach|-a</code> flag.</li>
</ul>
</li>
<li>
<p><code>capitan restart</code> Restart containers</p>

<ul>
<li>Further arguments passed through to docker, example <code>capitan start -t 5</code>
</li>
</ul>
</li>
<li>
<p><code>capitan stop</code>    Stop running containers</p>

<ul>
<li>Further arguments passed through to docker, example <code>capitan stop -t 5</code>
</li>
</ul>
</li>
<li>
<p><code>capitan kill</code>    Kill running containers using SIGKILL or a specified signal</p>

<ul>
<li>Further arguments passed through to docker, example <code>capitan kill --signal KILL</code>
</li>
</ul>
</li>
<li>
<p><code>capitan rm</code>      Remove stopped containers</p>

<ul>
<li>Further arguments passed through to docker, example <code>capitan rm -f</code>
</li>
</ul>
</li>
</ul>

<h3>
<a id="non-invasive-commands" class="anchor" href="#non-invasive-commands" aria-hidden="true"><span class="octicon octicon-link"></span></a>Non invasive commands</h3>

<ul>
<li>
<p><code>capitan ps</code>      Show container status</p>

<ul>
<li>Further arguments passed through to docker, example <code>capitan ps -a</code>
</li>
</ul>
</li>
<li><p><code>capitan ip</code>      Show container ip addresses</p></li>
<li><p><code>capitan logs</code>    Follow container logs</p></li>
<li><p><code>capitan pull</code>    Pull images for all containers</p></li>
<li><p><code>capitan build</code>   Build any containers with 'build' flag set (WIP)</p></li>
</ul>

<h2>
<a id="why" class="anchor" href="#why" aria-hidden="true"><span class="octicon octicon-link"></span></a>Why...</h2>

<h3>
<a id="not-docker-compose" class="anchor" href="#not-docker-compose" aria-hidden="true"><span class="octicon octicon-link"></span></a>...not docker-compose?</h3>

<ol>
<li>lack of variables</li>
<li>options support is always behind actual docker version</li>
<li>up restarts containers in wrong order</li>
<li>no hooks system</li>
<li>hassle free replacement for non x86/x86_64 architectures</li>
</ol>

<h3>
<a id="not-crowdr" class="anchor" href="#not-crowdr" aria-hidden="true"><span class="octicon octicon-link"></span></a>...not crowdr?</h3>

<p>Written totally in bash. I love bash but I personally feel safer with go. That is all.</p>

<h2>
<a id="capitan-features" class="anchor" href="#capitan-features" aria-hidden="true"><span class="octicon octicon-link"></span></a>Capitan Features</h2>

<ol>
<li>Shell Support - Config is read from stdout of a shell command. Extremely flexible</li>
<li>Hooks - hooks for before and after every intrusive action</li>
<li>Predictable run sequence - containers started in order defined</li>
<li>Future proof - options are passed through on most commands to docker cli, very simple.</li>
</ol>

<h2>
<a id="configuration" class="anchor" href="#configuration" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configuration</h2>

<h3>
<a id="global-options" class="anchor" href="#global-options" aria-hidden="true"><span class="octicon octicon-link"></span></a>Global options</h3>

<pre><code> --cmd, -c "./capitan.cfg.sh"   command used to obtain config
 --debug, -d                    print extra log messages
 --dry-run, --dry               preview outcome, no changes will be made
 --help, -h                     show help
 --version, -v                  print the version
</code></pre>

<h3>
<a id="config-fileoutput" class="anchor" href="#config-fileoutput" aria-hidden="true"><span class="octicon octicon-link"></span></a>Config file/output</h3>

<p>Service config is read from stdout of the command defined with <code>--cmd</code> .</p>

<p><code>capitan</code> by default runs the command <code>./capitan.cfg.sh</code> in the current directory to get the config. This can be customized with <code>-c</code> flag.</p>

<p>You could use any command which generates a valid config. It doesn't have to be a bash script like in the example or default.</p>

<p>The output format must be:</p>

<pre><code>CONTAINER_NAME COMMAND [ARGS...]
</code></pre>

<p>All commands are passed through to docker cli as <code>--COMMAND</code> EXCEPT the following:</p>

<h4>
<a id="build" class="anchor" href="#build" aria-hidden="true"><span class="octicon octicon-link"></span></a><code>build</code>
</h4>

<p>This allows a path to be given for a dockerfile.</p>

<h4>
<a id="hook" class="anchor" href="#hook" aria-hidden="true"><span class="octicon octicon-link"></span></a><code>hook</code>
</h4>

<p>Allows for a custom shell command to be evaluated at the following points:</p>

<ul>
<li>Before/After Run (<code>before.run</code>, <code>after.run</code>)

<ul>
<li>This occurs during the <code>up</code> command</li>
</ul>
</li>
<li>Before/After Start (<code>before.start</code>, <code>after.start</code>)

<ul>
<li>This will occur in the <code>up</code>, <code>start</code> and <code>restart</code> command</li>
</ul>
</li>
<li>Before/After Stop (<code>before.stop</code>, <code>after.stop</code>)

<ul>
<li>This will occur in the <code>stop</code> command only</li>
</ul>
</li>
<li>Before/After Kill (<code>before.kill</code>, <code>after.kill</code>)

<ul>
<li>This will occur in the <code>kill</code> command only</li>
</ul>
</li>
<li>Before/After Rm (<code>before.rm</code>, <code>after.rm</code>)

<ul>
<li>This will occur in the <code>up</code> and <code>rm</code> command</li>
</ul>
</li>
</ul>

<p><em>NOTE</em> hooks do not conform exactly to each command. Example: an <code>up</code> command may <code>rm</code> and then <code>run</code> a container OR just <code>start</code> a stopped container.</p>

<h4>
<a id="global-project" class="anchor" href="#global-project" aria-hidden="true"><span class="octicon octicon-link"></span></a><code>global project</code>
</h4>

<p>The project name, defaults to current working directory</p>

<h4>
<a id="global-project_sep" class="anchor" href="#global-project_sep" aria-hidden="true"><span class="octicon octicon-link"></span></a><code>global project_sep</code>
</h4>

<p>String to use to create container name from <code>project</code> and name specified in config</p>

<h3>
<a id="example-config-" class="anchor" href="#example-config-" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example Config :</h3>

<pre><code>#!/bin/bash
PREFIX=dev

cat &lt;&lt;EOF
#
# General redis container
#
redis image redis:latest
redis hostname ${PREFIX}_redis
redis publish 6379
redis hook after.run sleep 10
redis hook after.start sleep 10

#
# General mongodb container
#
mongo image mongo:latest
mongo command mongod --smallfiles
mongo hostname ${PREFIX}_mongo
mongo publish 27017

#
# My app
#
app build ./
app publish 80
app link redis
app link mongo:mongodb
EOF
</code></pre>

<h2>
<a id="roadmap" class="anchor" href="#roadmap" aria-hidden="true"><span class="octicon octicon-link"></span></a>Roadmap</h2>

<ol>
<li>Tests</li>
<li>Scaling (multiple instances of same container)</li>
<li>More efficient <code>up</code> logic</li>
<li>Helpful aliases in shell env.</li>
<li>More flexible <code>build</code> command</li>
</ol>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/byrnedo/capitan">Capitan</a> is maintained by <a href="https://github.com/byrnedo">byrnedo</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
